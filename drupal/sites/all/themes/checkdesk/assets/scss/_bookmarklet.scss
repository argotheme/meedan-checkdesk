$spinner-width: 45px; 
$bookmarklet-width: 345px;
$bookmarklet-preview-max-height: 345px;
$bookmarklet-height: $bookmarklet-width + ($bookmarklet-width * 0.61803);

// Bookmarklet forms
@mixin bookmarklet-forms() {
  
  form {
    @include reset-box-model;
    width: $bookmarklet-width;
  }

  .form-item {
    @include reset-box-model;
    float: $from-direction;
    clear: both;

    .description {
      width: $bookmarklet-width - $gutter-width * 2;
    }
  }

  .field-type-link-field {
    clear: both;
    label {
      display: none; // HACK hidden labels
    }
  }

  .field-edit-link {
    display: none; // HACK hidden
  }


  .link-field-url {
    input[type=text], 
    input[type=password], 
    textarea {
      @include border-radius($radius);
    }

    input[type=text] {
      width: $bookmarklet-width - ($spinner-width + $gutter-width*2);
      padding-#{opposite-position($from-direction)}: $spinner-width; //accomodate spinner
    }
  }

  form input[type=text] {
    width: $bookmarklet-width - $gutter-width * 2;
  }

  .form-type-textarea {
    padding-top: $gutter-width;
  }

  textarea {
    width: $bookmarklet-width - 10px; // account for padding
    height: 60px;
    padding: 5px;
  }

  .form-actions {
    @include reset-box-model;
    background: transparent;
    float: $from-direction;
    width: auto;
    margin-top: $gutter-width;
    padding-top: $gutter-width;
    border-top: 0;
  }

  .footer {
    float: $from-direction;
    clear: both;
    margin-top: $gutter-width;
    input {
      @include checkdesk-button();
    }
  }

}

@mixin bookmarklet-step-one() {
  // Step one  ...
  h2 {
    @include reset-box-model;
    color: $grey;
    font-size: $base-font-size;
    float: $from-direction;
    margin-bottom: 0;
    padding-top: $gutter-width;
    line-height: $absolute-line-height;
  }

  #meedan_bookmarklet_help {
    // position: absolute;
    // top: 0;
    padding-top: $absolute-line-height / 3;
    line-height: $absolute-line-height;
    // #{$omega-float}: $gutter-width;

    span {
      display: block;
      float: $from-direction;
      width: 30px;
      text-indent: -5000em;
      background: transparent url(../imgs/icons/bookmarklet-help.png) center center no-repeat;
      cursor: help;
      p {
        display: none;
      }

      &:hover p {
        display: block;
        width: 240px;
        height: auto;
        background: white;
        border: 1px solid $grayLighter;
        font-size: $small-font-size;
        line-height: 1.2;
        color: $grayLight;
        text-indent: 0;
        padding: $gutter-width;
        position: absolute;
        #{opposite-position($from-direction)}: 1px;
      }
    }
  }



  // Loading ..
  .meedan-bookmarklet-loading {
    background: $white url(../imgs/icons/bookmarklet-loading.gif) opposite-position($from-direction) center no-repeat;
  }
}

// Step two  ...
@mixin bookmarklet-step-two() {
  #meedan_bookmarklet_preview {
    clear: both;
    float: left;
    color: $dark-grey;
    margin: $gutter-width 0;
  }

  #meedan_bookmarklet_preview_content img {
    width: auto;
    float: $from-direction;
    clear: both;
  }

  #meedan_bookmarklet_preview_content,
  #meedan_bookmarklet_preview_gc {
    width: 332px;
    height: auto;
    max-height: $bookmarklet-preview-max-height;
    display: inline-block;
    float: $from-direction;
    overflow: hidden;
  }

  #meedan_bookmarklet_preview_gc {
    background: $grey;
    color: $dark-grey;
    padding-top: 85px;
    height: $bookmarklet-preview-max-height;
    max-height: 145px;
    span, a {
      text-align: center;
      display: block;
      width: 100%;
    }
    span {
      font-size: 15px;
      margin-bottom: 5px;
    }
    a, a:visited, a:link, a:hover {
      text-decoration: none;
      color: #fff;
      font-weight: bold;
    }
  }

  .fb-status-preview {
    background: $light-grey;
    padding: $gutter-width;
    @include border-radius($radius);

    .author {
      float: right;
      clear: both;
    }
  }

  #edit-body {
    float: $from-direction;
    clear: both;
  }

  #edit-graphic-content {
    float: $from-direction;
    clear: both;
    margin: $gutter-width 0 0 ($gutter-width + $checkbox-width - 20px); // align with the button
    width: 100%;
    & > .form-type-checkbox {
      width: 100%;
    }
    .form-item label,
    .form-item input[type="checkbox"] {
      // padding: $gutter-width 2px; // pad for the hover
      &:hover {
        color: $identity;
      }
    }
  }
}

// Alerts in bookmarklet
@mixin bookmarklet-alerts() {
 
  .absolute-messages-status, .messages.status, #absolute-messages-show, .absolute-messages-dismiss-all, #absolute-messages-messages {
    display: none !important; // HACK hide status messages in bookmarklet
  }

  // Error messages
  .messages.error {
    clear: both;
    background: transparent;
    padding: 0;
    border: 0;
    color: #a00;
  }

  #meedan_bookmarklet_messages {
    padding: 0;
    margin: 0;
    font-size: $small-font-size;
    clear: both;
    li {
      display: block;
      list-style: none;
    }
    a, a:link, a:visited, a:hover {
      text-decoration: none;
      color: #848484;
      line-height: $base-font-size;
    }
  }

}

// Login
@mixin bookmarklet-login() {
  #user-login {
    label, 
    input[type=text], 
    input[type=password], 
    a {
      clear: both;
    }
    ul {
      margin: 0;
    }
    li {
      list-style: none;
      display: block;
      margin: 0;
    }
    .messages.error {
      position: static;
      font-size: modular-scale(0) - modular-scale(-3); // 14px
      margin-bottom: $absolute-line-height/3;
    }
    #edit-social-media-signin {
      margin-top: $absolute-line-height/2;
      .item-list li a {
        padding: $absolute-line-height/3 $gutter-width;
      }
    }
    .or {
      margin: 0 0;
    }
    .user-links {
      clear: both;
      font-size: modular-scale(0) - modular-scale(-3); // 14px
      padding-#{$omega}: $gutter-width;
    }
    .form-item-remember-me {
      clear: none;
      label { font-size: modular-scale(0) - modular-scale(-3); } // 14px 
    }
    .user-new-account-link {
      .register {
        text-align: $omega;
        font-size: modular-scale(0) - modular-scale(-3); // 14px
      }
    }
    // username/pass field widths
    input[type=text], 
    input[type=password] {
      width: $bookmarklet-width - $gutter-width*2;
      padding-#{$omega}: 0;
    }
    .form-actions {
      margin-top: $absolute-line-height/2;
    }
  }
}


// Internal bookmarklet (Submit Report link)
// ==============================================================
#nav-media-form {
  @include ctb-clearfix;
  width: 366px;

  iframe {
    width: 100%;
  }
}

// NOTE applied to body
.meedan-bookmarklet-internal {
  #meedan_bookmarklet_preview,
    #edit-body,
    #edit-graphic-content,
    #edit-actions #edit-submit,
    #edit-title {
    display: none;
  }
}


// Bookmarklet
// ==============================================================

// The bookmarklet itself
// NOTE: applied to html
#meedan_bookmarklet_html {
  height: auto;
  background: $white;
}

#meedan_bookmarklet {
  font-size: $small-font-size;
  overflow: hidden;
  position: relative;
  padding: 0;
  @include bookmarklet-forms;
  @include bookmarklet-login;
  @include bookmarklet-alerts;
  @include bookmarklet-step-one;
  @include bookmarklet-step-two;
}

#meedan_bookmarklet_close {
  top: 20px;
  #{$from-direction}: $bookmarklet-width - 30; // the close icon is 30px wide
  #{opposite-position($from-direction)}: auto;
  z-index: 2;
}

// ===========================================================================
// Breakpoints 

@include at-breakpoint($break-small) {
  // same as previous breakpoint
}

@include at-breakpoint($break-medium) {
  // same as previous breakpoint
}

@include at-breakpoint($break-large) {
  // same as previous breakpoint
}


// Fixed only for normal screen sizes
@media all and (max-height: 42em) {
  #nav-media-form {
    max-height: 290px;
    overflow-y: scroll;
  }
}