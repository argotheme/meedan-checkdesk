From bcf1bb3187b6991987036a04637764f3b2229617 Mon Sep 17 00:00:00 2001
From: Caio SBA <caiosba@gmail.com>
Date: Sun, 30 Dec 2012 23:57:02 -0200
Subject: [PATCH] The Ajax pager handler must be attached by the closest parent, not for the outer most

---
 js/ajax_view.js |   11 ++---------
 1 files changed, 2 insertions(+), 9 deletions(-)

diff --git a/js/ajax_view.js b/js/ajax_view.js
index 2a4012f..c108d05 100644
--- a/js/ajax_view.js
+++ b/js/ajax_view.js
@@ -62,9 +62,6 @@ Drupal.views.ajaxView = function(settings) {
 
   // Add the ajax to pagers.
   this.$view
-    // Don't attach to nested views. Doing so would attach multiple behaviors
-    // to a given element.
-    .filter(jQuery.proxy(this.filterNestedViews, this))
     .once(jQuery.proxy(this.attachPagerAjax, this));
 };
 
@@ -75,12 +72,6 @@ Drupal.views.ajaxView.prototype.attachExposedFormAjax = function() {
   this.exposedFormAjax = new Drupal.ajax($(button).attr('id'), button, this.element_settings);
 };
 
-Drupal.views.ajaxView.prototype.filterNestedViews= function() {
-  // If there is at least one parent with a view class, this view
-  // is nested (e.g., an attachment). Bail.
-  return !this.$view.parents('.view').size();
-};
-
 /**
  * Attach the ajax behavior to each link.
  */
@@ -94,6 +85,8 @@ Drupal.views.ajaxView.prototype.attachPagerAjax = function() {
  */
 Drupal.views.ajaxView.prototype.attachPagerLinkAjax = function(id, link) {
   var $link = $(link);
+  // Don't attach to pagers inside nested views.
+  if (!$link.closest('.view').is(this.$view)) return;
   var viewData = {};
   var href = $link.attr('href');
   // Construct an object using the settings defaults and then overriding
-- 
1.7.2.5

