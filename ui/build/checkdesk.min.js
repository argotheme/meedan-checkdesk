/*! checkdesk - v0.1.0 */
var app=angular.module("Checkdesk",["pascalprecht.translate","cd.l10n","cd.translationUI","cd.page","cd.services"]),cdServices=angular.module("cd.services",["ngResource","cd.csrfToken"]);app.config(["$routeProvider","$locationProvider",function(r,e){e.html5Mode(!0).hashPrefix("!"),r.when("/reports",{templateUrl:"templates/reports.html",controller:ReportsCtrl}),r.when("/report/add",{templateUrl:"templates/reportForm.html",controller:ReportFormCtrl}),r.when("/report/:nid",{templateUrl:"templates/report.html",controller:ReportCtrl}),r.when("/report/:nid/edit",{templateUrl:"templates/reportForm.html",controller:ReportFormCtrl}),r.when("/translationsTest",{templateUrl:"templates/translationsTest.html",controller:TranslationsTestCtrl}),r.otherwise({redirectTo:"/reports"})}]),angular.module("cd.csrfToken",[]).config(["$httpProvider",function(r){r.defaults.xsrfCookieName="CSRF-Token",r.defaults.xsrfHeaderName="X-CSRF-Token"}]),angular.module("cd.l10n",["ngCookies","pascalprecht.translate","cd.translationUI"]).config(["$translateProvider",function(r){r.useUrlLoader("api/i18n?textgroup=ui&angular=1"),r.preferredLanguage("ar"),r.useCookieStorage(),r.useMissingTranslationHandler("cdTranslationUI")}]),angular.module("cd.page",[]).factory("pageState",function(){var r="loading",e="Checkdesk";return{status:function(e){return e&&(r=e),r},title:function(r){return r&&(e=r),e}}}),cdServices.factory("Comment",["$resource",function(r){return r("api/node/:nid/comments",{},{query:{method:"GET",isArray:!0}})}]),cdServices.factory("Report",["$resource","$http",function(r){var e=r("api/node/:nid",{nid:"@nid"},{query:{method:"GET",params:{nid:"","parameters[type]":"media",pagesize:5},isArray:!0},get:{method:"GET",isArray:!1},save:{method:"POST",params:{nid:""}},update:{method:"PUT"}});return angular.extend(e.prototype,{save:function(r){return this.nid?this.$update(r):this.$save(r)}}),e}]),cdServices.factory("ReportActivity",["$resource",function(r){return r("api/views/activity_report",{},{query:{method:"GET",params:{display_id:"services_1",args:[]},isArray:!0}})}]),cdServices.factory("System",["$resource",function(r){return r("api/system/:verb",{},{connect:{method:"POST",params:{verb:"connect"},isArray:!1}})}]),cdServices.factory("Translation",["$resource","$http",function(r){var e=r("api/i18n/:lid",{lid:"@lid"},{query:{method:"GET",params:{lid:"",textgroup:"ui"},isArray:!1},save:{method:"POST",params:{lid:""}},update:{method:"PUT"},remove:{method:"DELETE"}});return angular.extend(e.prototype,{save:function(r){return this.lid?this.$update(r):this.$save(r)}}),e}]),cdServices.factory("User",["$resource","$http",function(r,e){return r("api/user/:verb",{},{login:{method:"POST",params:{verb:"login"},isArray:!1},logout:{method:"POST",params:{verb:"logout"},isArray:!1,transformResponse:e.defaults.transformResponse.concat([function(r){return angular.isArray(r)&&r.length>0?{result:r[0]}:{result:!1}}])}})}]),angular.module("cd.translationUI",["pascalprecht.translate"]).provider("cdTranslationUI",function(){var r,e=[],t=function(r){-1===e.indexOf(r)&&e.push(r)};this.translationTable=function(e){return angular.isUndefined(e)||(r=e),r},this.missingTranslations=function(){return e},t.translationTable=this.translationTable,t.missingTranslations=this.missingTranslations,this.$get=function(){return t}}).config(["$translateProvider","cdTranslationUIProvider",function(r,e){e.translationTable(r.translations())}]).controller("cdTranslationUICtrl",["$scope","$translate","cdTranslationUI",function(r,e,t){var n={};r.collapsed=!0,r.toggle=function(){r.collapsed=!r.collapsed},r.$translate=e,r.cdTranslationUI=t,r.translationTable=t.translationTable(),r.editedTranslations={},r.languages=function(){var e,t=[];for(e in r.translationTable)r.translationTable.hasOwnProperty(e)&&t.push(e);return t},r.translationSources=function(){var e,a,o,s,i=t.translationTable(),l=t.missingTranslations(),u=r.languages();for(e in i)if(i.hasOwnProperty(e))for(a in i[e])if(i[e].hasOwnProperty(a)&&!a.match(/^\$\$/)){for(n[a]=n[a]||{},s=u.length-1;s>=0;s--)n[a][u[s]]="";n[a][e]=i[e][a]}for(o=l.length-1;o>=0;o--)if(a=l[o],angular.isUndefined(n[a]))for(n[a]={},s=u.length-1;s>=0;s--)angular.isUndefined(n[a][u[s]])&&(n[a][u[s]]="");return n},r.translationChanged=function(t,n){r.translationTable[t][n]=r.editedTranslations[t][n],e.uses(e.uses())}}]);var HeaderCtrl=["$scope","$translate","System","User",function(r,e,t,n){var a=function(r,e){switch(r){case"remove":$("html").removeClass(e);break;case"add":$("html").addClass(e)}};a("add",e.uses()),r.toggleLang=function(){a("remove",e.uses()),"en-NG"===e.uses()?e.uses("ar"):e.uses("en-NG"),a("add",e.uses())};var o={uid:0};r.isLoggedIn=!1,r.user=angular.copy(o),t.connect({},function(e){r.user=e.user,r.isLoggedIn=!angular.isUndefined(e.user)&&e.user.uid>0}),r.login=function(){return r.user.name&&r.user.pass?(r.user&&0!==r.user.uid||n.login({username:r.user.name,password:r.user.pass},function(e){r.user=e.user,r.isLoggedIn=!angular.isUndefined(e.user)&&e.user.uid>0}),void 0):!1},r.logout=function(){n.logout({},function(e){e.result&&(r.user=angular.copy(o),r.isLoggedIn=!1)})}}];app.controller("HeaderCtrl",HeaderCtrl);var PageCtrl=["$scope","pageState",function(r,e){r.pageState=e}];app.controller("PageCtrl",PageCtrl);var ReportCtrl=["$scope","$routeParams","pageState","Report","ReportActivity",function(r,e,t,n,a){r.report=n.get({nid:e.nid},function(){t.status("ready")}),r.reportActivity=a.query({args:[e.nid]})}];app.controller("ReportCtrl",ReportCtrl);var ReportFormCtrl=["$scope","$routeParams","$location","Report",function(r,e,t,n){r.report=e.nid?n.get({nid:e.nid}):new n({title:"",type:"media",body:{und:[{url:""}]},field_link:{und:[{url:""}]}}),r.submit=function(){return r.report.save(function(r){t.path("/report/"+r.nid)}),!1},r.cancel=function(){e.nid?t.path("/report/"+e.nid):t.path("/")}}];app.controller("ReportFormCtrl",ReportFormCtrl);var ReportsCtrl=["$scope","pageState","Report",function(r,e,t){r.reports=[],t.query(function(n){for(var a=0;n.length>a;a++)r.reports.push(t.get({nid:n[a].nid}));e.status("ready")})}];app.controller("ReportsCtrl",ReportsCtrl);var TranslationsTestCtrl=["$scope","$translate","Translation",function(r,e,t){r.translations=t.query({language:e.uses()}),r.translation=new t({language:"",context:"",source:"",translation:"",textgroup:"",location:"",plid:"",plural:""}),r.submit=function(){return r.translation.save(),!1}}];app.controller("TranslationsTestCtrl",TranslationsTestCtrl);