/*! checkdesk - v0.1.0 */
var app=angular.module("Checkdesk",["pascalprecht.translate","cd.l10n","cd.translationUI","cd.page","cd.services"]),cdServices=angular.module("cd.services",["ngResource","cd.csrfToken"]);app.config(["$routeProvider","$locationProvider",function(r,e){e.html5Mode(!0).hashPrefix("!"),r.when("/liveblog",{templateUrl:"templates/liveblog.html",controller:LiveblogCtrl}),r.when("/reports",{templateUrl:"templates/reports.html",controller:ReportsCtrl}),r.when("/report/add",{templateUrl:"templates/reportForm.html",controller:ReportFormCtrl}),r.when("/report/:nid",{templateUrl:"templates/report.html",controller:ReportCtrl}),r.when("/report/:nid/edit",{templateUrl:"templates/reportForm.html",controller:ReportFormCtrl}),r.when("/translationsTest",{templateUrl:"templates/translationsTest.html",controller:TranslationsTestCtrl}),r.otherwise({redirectTo:"/liveblog"})}]),angular.module("cd.csrfToken",[]).config(["$httpProvider",function(r){r.defaults.xsrfCookieName="CSRF-Token",r.defaults.xsrfHeaderName="X-CSRF-Token"}]),angular.module("cd.l10n",["ngCookies","pascalprecht.translate","cd.translationUI"]).config(["$translateProvider",function(r){r.useUrlLoader("api/i18n?textgroup=ui&angular=1"),r.preferredLanguage("ar"),r.useCookieStorage(),r.useMissingTranslationHandler("cdTranslationUI")}]),angular.module("cd.page",[]).factory("pageState",function(){var r="loading",e="Checkdesk";return{status:function(e){return e&&(r=e),r},title:function(r){return r&&(e=r),e}}}),cdServices.factory("Comment",["$resource",function(r){return r("api/node/:nid/comments",{},{query:{method:"GET",isArray:!0}})}]),cdServices.factory("Liveblog",["$resource",function(r){return r("api/views/liveblog",{},{query:{method:"GET",params:{display_id:"services_1",args:[]},isArray:!0}})}]),cdServices.factory("Report",["$resource","$http",function(r){var e=r("api/node/:nid",{nid:"@nid"},{query:{method:"GET",params:{nid:"","parameters[type]":"media",pagesize:5},isArray:!0},get:{method:"GET",isArray:!1},save:{method:"POST",params:{nid:""}},update:{method:"PUT"}});return angular.extend(e.prototype,{save:function(r){return this.nid?this.$update(r):this.$save(r)}}),e}]),cdServices.factory("ReportActivity",["$resource",function(r){return r("api/views/activity_report",{},{query:{method:"GET",params:{display_id:"services_1",args:[]},isArray:!0}})}]),cdServices.factory("Story",["$resource","$http",function(r){var e=r("api/node/:nid",{nid:"@nid"},{query:{method:"GET",params:{nid:"","parameters[type]":"discussion",pagesize:5},isArray:!0},get:{method:"GET",isArray:!1},save:{method:"POST",params:{nid:""}},update:{method:"PUT"}});return angular.extend(e.prototype,{save:function(r){return this.nid?this.$update(r):this.$save(r)}}),e}]),cdServices.factory("System",["$resource",function(r){return r("api/system/:verb",{},{connect:{method:"POST",params:{verb:"connect"},isArray:!1}})}]),cdServices.factory("Translation",["$resource","$http",function(r){var e=r("api/i18n/:lid",{lid:"@lid"},{query:{method:"GET",params:{lid:"",textgroup:"ui"},isArray:!1},save:{method:"POST",params:{lid:""}},update:{method:"PUT"},remove:{method:"DELETE"}});return angular.extend(e.prototype,{save:function(r){return this.lid?this.$update(r):this.$save(r)}}),e}]),cdServices.factory("Update",["$resource","$http",function(r){var e=r("api/node/:nid",{nid:"@nid"},{query:{method:"GET",params:{nid:"","parameters[type]":"post",pagesize:5},isArray:!0},get:{method:"GET",isArray:!1},save:{method:"POST",params:{nid:""}},update:{method:"PUT"}});return angular.extend(e.prototype,{save:function(r){return this.nid?this.$update(r):this.$save(r)}}),e}]),cdServices.factory("User",["$resource","$http",function(r,e){return r("api/user/:verb",{},{login:{method:"POST",params:{verb:"login"},isArray:!1},logout:{method:"POST",params:{verb:"logout"},isArray:!1,transformResponse:e.defaults.transformResponse.concat([function(r){return angular.isArray(r)&&r.length>0?{result:r[0]}:{result:!1}}])}})}]),angular.module("cd.translationUI",["pascalprecht.translate"]).provider("cdTranslationUI",function(){var r,e={},t=function(r,t){angular.isUndefined(e[t])&&(e[t]={}),angular.isUndefined(e[t][r])&&(e[t][r]="")};this.translationTable=function(e){return angular.isUndefined(e)||(r=e),r},this.missingTranslations=function(){return e},t.translationTable=this.translationTable,t.missingTranslations=this.missingTranslations,this.$get=function(){return t}}).config(["$translateProvider","cdTranslationUIProvider",function(r,e){e.translationTable(r.translations())}]).controller("cdTranslationUICtrl",["$scope","$translate","cdTranslationUI","Translation",function(r,e,t,a){r.collapsed=!0,r.toggle=function(){r.collapsed=!r.collapsed},r.$translate=e,r.cdTranslationUI=t,r.translationTable=t.translationTable(),r.missingTranslations=t.missingTranslations(),r.allTranslations={},r.languages=[],r.$watch("translationTable",function(e){r.languages=[],angular.forEach(newV,function(e,t){r.languages.push(t)}),angular.forEach(e,function(e,t){angular.forEach(e,function(e,a){angular.isUndefined(r.allTranslations[a])&&(r.allTranslations[a]={}),angular.isUndefined(r.allTranslations[a][t])&&(r.allTranslations[a][t]=e),angular.forEach(r.languages,function(e){angular.isUndefined(r.allTranslations[a][e])&&(r.allTranslations[a][e]="")})})})},!0),r.$watch("missingTranslations",function(e){angular.forEach(e,function(e,t){angular.forEach(e,function(e,a){angular.isUndefined(r.allTranslations[a])&&(r.allTranslations[a]={}),angular.isUndefined(r.allTranslations[a][t])&&(r.allTranslations[a][t]=e),angular.forEach(r.languages,function(e){angular.isUndefined(r.allTranslations[a][e])&&(r.allTranslations[a][e]="")})})})},!0),r.translationChanged=function(){},r.save=function(t,n){var s;return r.allTranslations[n][t]?(s=new a({language:t,source:n,translation:r.allTranslations[n][t],textgroup:"ui"}),s.save(function(){r.translationTable[t][n]=r.allTranslations[n][t],e.uses(e.uses())}),void 0):!1}}]);var HeaderCtrl=["$scope","$translate","System","User",function(r,e,t,a){var n=function(r,e){switch(r){case"remove":$("html").removeClass(e);break;case"add":$("html").addClass(e)}};n("add",e.uses()),r.toggleLang=function(){n("remove",e.uses()),"en-NG"===e.uses()?e.uses("ar"):e.uses("en-NG"),n("add",e.uses())};var s={uid:0};r.isLoggedIn=!1,r.user=angular.copy(s),t.connect({},function(e){r.user=e.user,r.isLoggedIn=!angular.isUndefined(e.user)&&e.user.uid>0}),r.login=function(){return r.user.name&&r.user.pass?(r.user&&0!==r.user.uid||a.login({username:r.user.name,password:r.user.pass},function(e){r.user=e.user,r.isLoggedIn=!angular.isUndefined(e.user)&&e.user.uid>0}),void 0):!1},r.logout=function(){a.logout({},function(e){e.result&&(r.user=angular.copy(s),r.isLoggedIn=!1)})}}];app.controller("HeaderCtrl",HeaderCtrl);var LiveblogCtrl=["$scope","pageState","Story",function(r,e,t){r.stories=[],t.query(function(a){for(var n=0;a.length>n;n++)r.stories.push(t.get({nid:a[n].nid}));e.status("ready")})}];app.controller("LiveblogCtrl",LiveblogCtrl);var PageCtrl=["$scope","pageState",function(r,e){r.pageState=e}];app.controller("PageCtrl",PageCtrl);var ReportCtrl=["$scope","$routeParams","pageState","Report","ReportActivity",function(r,e,t,a,n){r.report=a.get({nid:e.nid},function(){t.status("ready")}),r.reportActivity=n.query({args:[e.nid]})}];app.controller("ReportCtrl",ReportCtrl);var ReportFormCtrl=["$scope","$routeParams","$location","Report",function(r,e,t,a){r.report=e.nid?a.get({nid:e.nid}):new a({title:"",type:"media",body:{und:[{url:""}]},field_link:{und:[{url:""}]}}),r.submit=function(){return r.report.save(function(r){t.path("/report/"+r.nid)}),!1},r.cancel=function(){e.nid?t.path("/report/"+e.nid):t.path("/")}}];app.controller("ReportFormCtrl",ReportFormCtrl);var ReportsCtrl=["$scope","pageState","Report",function(r,e,t){r.reports=[],t.query(function(a){for(var n=0;a.length>n;n++)r.reports.push(t.get({nid:a[n].nid}));e.status("ready")})}];app.controller("ReportsCtrl",ReportsCtrl);var TranslationsTestCtrl=["$scope","$translate","Translation",function(r,e,t){r.translations=t.query({language:e.uses()}),r.translation=new t({language:"",context:"",source:"",translation:"",textgroup:"",location:"",plid:"",plural:""}),r.submit=function(){return r.translation.save(),!1}}];app.controller("TranslationsTestCtrl",TranslationsTestCtrl);