/*! checkdesk - v0.1.0 */
var app=angular.module("Checkdesk",["pascalprecht.translate","cd.l10n","cd.translationUI","cd.page","cd.services"]),cdServices=angular.module("cd.services",["ngResource"]);app.config(["$routeProvider","$locationProvider",function(r,t){t.html5Mode(!0).hashPrefix("!"),r.when("/reports",{templateUrl:"templates/reports.html",controller:ReportsCtrl}),r.when("/report/add",{templateUrl:"templates/reportForm.html",controller:ReportFormCtrl}),r.when("/report/:nid",{templateUrl:"templates/report.html",controller:ReportCtrl}),r.when("/report/:nid/edit",{templateUrl:"templates/reportForm.html",controller:ReportFormCtrl}),r.when("/translationsTest",{templateUrl:"templates/translationsTest.html",controller:TranslationsTestCtrl}),r.otherwise({redirectTo:"/reports"})}]),angular.module("cd.l10n",["pascalprecht.translate","cd.translationUI"]).config(["$translateProvider",function(r){r.translations("en",{}),r.translations("ar",{}),r.uses("ar"),r.useMissingTranslationHandler("cdTranslationUI")}]).run(["$translate","cdTranslationUI","Translation",function(r,t,e){e.query({},function(e){var n,a,s,o,i,l=["ar","en"];for(n=t.translationTable(),o=l.length-1;o>=0;o--)if(a=l[o],e.hasOwnProperty(a))for(i=e[a].length-1;i>=0;i--)s=e[a][i],n[a][s.source]=s.translation;r.uses(r.uses())})}]),angular.module("cd.page",[]).factory("PageState",function(){var r="loading",t="Checkdesk";return{status:function(t){return t&&(r=t),r},title:function(r){return r&&(t=r),t}}}),cdServices.factory("Comment",["$resource",function(r){return r("api/node/:nid/comments",{},{query:{method:"GET",isArray:!0}})}]),cdServices.factory("Report",["$resource","$http",function(r){var t=r("api/node/:nid",{nid:"@nid"},{query:{method:"GET",params:{nid:"","parameters[type]":"media",pagesize:5},isArray:!0},get:{method:"GET",isArray:!1},save:{method:"POST",params:{nid:""}},update:{method:"PUT"}});return angular.extend(t.prototype,{save:function(r){return this.nid?this.$update(r):this.$save(r)}}),t}]),cdServices.factory("ReportActivity",["$resource",function(r){return r("api/views/activity_report",{},{query:{method:"GET",params:{display_id:"services_1",args:[]},isArray:!0}})}]),cdServices.factory("System",["$resource",function(r){return r("api/system/:verb",{},{connect:{method:"POST",params:{verb:"connect"},isArray:!1}})}]),cdServices.factory("Translation",["$resource","$http",function(r){var t=r("api/i18n/:lid",{lid:"@lid"},{query:{method:"GET",params:{lid:"",textgroup:"ui"},isArray:!1},save:{method:"POST",params:{lid:""}},update:{method:"PUT"},remove:{method:"DELETE"}});return angular.extend(t.prototype,{save:function(r){return this.lid?this.$update(r):this.$save(r)}}),t}]),cdServices.factory("User",["$resource","$http",function(r,t){return r("api/user/:verb",{},{login:{method:"POST",params:{verb:"login"},isArray:!1},logout:{method:"POST",params:{verb:"logout"},isArray:!1,transformResponse:t.defaults.transformResponse.concat([function(r){return angular.isArray(r)&&r.length>0?{result:r[0]}:{result:!1}}])}})}]),angular.module("cd.translationUI",[]).provider("cdTranslationUI",function(){var r,t=[],e=function(r){-1===t.indexOf(r)&&t.push(r)};this.translationTable=function(t){return angular.isUndefined(t)||(r=t),r},this.missingTranslations=function(){return t},e.translationTable=this.translationTable,e.missingTranslations=this.missingTranslations,this.$get=function(){return e}}).config(["$translateProvider","cdTranslationUIProvider",function(r,t){t.translationTable(r.translations())}]).controller("cdTranslationUICtrl",["$scope","$translate","cdTranslationUI",function(r,t,e){r.collapsed=!0,r.toggle=function(){r.collapsed=!r.collapsed},r.translationTable=e.translationTable(),r.missingTranslations=e.missingTranslations(),r.inputTranslations=[],r.currentLanguage=t.uses(),r.translationChanged=function(e){var n=t.uses(),a=r.missingTranslations[e],s=r.inputTranslations[e];r.translationTable[n][a]=s,t.uses(n)}}]);var HeaderCtrl=["$scope","$translate","System","User",function(r,t,e,n){var a=function(r,t){switch(r){case"remove":$("html").removeClass(t);break;case"add":$("html").addClass(t)}};a("add",t.uses()),r.toggleLang=function(){a("remove",t.uses()),"en_EN"===t.uses()?t.uses("ar_AR"):t.uses("en_EN"),a("add",t.uses())};var s={uid:0};r.isLoggedIn=!1,r.user=angular.copy(s),e.connect({},function(t){r.user=t.user,r.isLoggedIn=!angular.isUndefined(t.user)&&t.user.uid>0}),r.login=function(){return r.user.name&&r.user.pass?(r.user&&0!==r.user.uid||n.login({username:r.user.name,password:r.user.pass},function(t){r.user=t.user,r.isLoggedIn=!angular.isUndefined(t.user)&&t.user.uid>0}),void 0):!1},r.logout=function(){n.logout({},function(t){t.result&&(r.user=angular.copy(s),r.isLoggedIn=!1)})}}];app.controller("HeaderCtrl",HeaderCtrl);var PageCtrl=["$scope","PageState",function(r,t){r.PageState=t}];app.controller("PageCtrl",PageCtrl);var ReportCtrl=["$scope","$routeParams","PageState","Report","ReportActivity",function(r,t,e,n,a){r.report=n.get({nid:t.nid},function(){e.status("ready")}),r.reportActivity=a.query({args:[t.nid]})}];app.controller("ReportCtrl",ReportCtrl);var ReportFormCtrl=["$scope","$routeParams","$location","Report",function(r,t,e,n){r.report=t.nid?n.get({nid:t.nid}):new n({title:"",type:"media",body:{und:[{url:""}]},field_link:{und:[{url:""}]}}),r.submit=function(){return r.report.save(function(r){e.path("/report/"+r.nid)}),!1},r.cancel=function(){t.nid?e.path("/report/"+t.nid):e.path("/")}}];app.controller("ReportFormCtrl",ReportFormCtrl);var ReportsCtrl=["$scope","PageState","Report",function(r,t,e){r.reports=[],e.query(function(n){for(var a=0;n.length>a;a++)r.reports.push(e.get({nid:n[a].nid}));t.status("ready")})}];app.controller("ReportsCtrl",ReportsCtrl);var TranslationsTestCtrl=["$scope","$translate","Translation",function(r,t,e){r.translations=e.query({language:t.uses()}),r.translation=new e({language:"",context:"",source:"",translation:"",textgroup:"",location:"",plid:"",plural:""}),r.submit=function(){return r.translation.save(),!1}}];app.controller("TranslationsTestCtrl",TranslationsTestCtrl);