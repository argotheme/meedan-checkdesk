/*! checkdesk - v0.1.0 */
var app=angular.module("Checkdesk",["pascalprecht.translate","cd.l10n","cd.translationUI","cd.page","cd.services","cd.liveblog","cd.report","cd.story"]),cdLiveblog=angular.module("cd.liveblog",["pascalprecht.translate"]),cdPage=angular.module("cd.page",["pascalprecht.translate"]),cdReport=angular.module("cd.report",["pascalprecht.translate"]),cdStory=angular.module("cd.story",["pascalprecht.translate"]),cdServices=angular.module("cd.services",["ngResource","cd.csrfToken"]);app.config(["$routeProvider","$locationProvider",function(e,t){t.html5Mode(!0).hashPrefix("!"),e.when("/liveblog",{templateUrl:"templates/liveblog.html",controller:"LiveblogCtrl"}),e.when("/reports",{templateUrl:"templates/reports.html",controller:"ReportsCtrl"}),e.when("/report/add",{templateUrl:"templates/reportForm.html",controller:"ReportFormCtrl"}),e.when("/report/:nid",{templateUrl:"templates/report.html",controller:"ReportCtrl"}),e.when("/report/:nid/edit",{templateUrl:"templates/reportForm.html",controller:"ReportFormCtrl"}),e.when("/translationsTest",{templateUrl:"templates/translationsTest.html",controller:"TranslationsTestCtrl"}),e.otherwise({redirectTo:"/liveblog"})}]),angular.module("cd.csrfToken",[]).config(["$httpProvider",function(e){e.defaults.xsrfCookieName="CSRF-Token",e.defaults.xsrfHeaderName="X-CSRF-Token"}]),angular.module("cd.l10n",["ngCookies","pascalprecht.translate","cd.translationUI"]).config(["$translateProvider",function(e){e.useUrlLoader("api/i18n?textgroup=ui&angular=1"),e.preferredLanguage("ar"),e.useCookieStorage(),e.useMissingTranslationHandler("cdTranslationUI")}]),cdLiveblog.controller("LiveblogCtrl",["$scope","pageState","Story",function(e,t,r){t.headTitle("Liveblog | Checkdesk"),t.title("Liveblog"),e.stories=[],r.query(function(a){for(var n=0;a.length>n;n++)e.stories.push(r.get({nid:a[n].nid}));t.status("ready")})}]),cdPage.controller("FooterCtrl",FooterCtrl=["$scope","$translate","System","User",function(e,t){e.informationMenu=[{title:t("INFORMATION_MENU_ITEM_ABOUT_TITLE"),href:"/about-checkdesk"}],e.footerMenu=[{title:t("FOOTER_MENU_ITEM_MEEDAN_TITLE"),href:"http://meedan.org"},{title:t("FOOTER_MENU_ITEM_CHECKDESK_TITLE"),href:"http://checkdesk.org"}]}]),cdPage.controller("NavbarCtrl",["$scope","$translate","System","User",function(e,t,r,a){var n=function(e,t){switch(e){case"remove":$("html").removeClass(t);break;case"add":$("html").addClass(t)}};e.mainMenu=[{title:t("MAIN_MENU_ITEM_HOME_TITLE"),href:"/",icon:"icon-home"},{title:t("MAIN_MENU_ITEM_REPORTS_TITLE"),href:"/reports",icon:"icon-eye-open"}],e.userMenu=[{title:t("USER_MENU_ITEM_LOGIN_TITLE"),href:"/user/login"}],n("add",t.uses()),e.toggleLang=function(){n("remove",t.uses()),"en-NG"===t.uses()?t.uses("ar"):t.uses("en-NG"),n("add",t.uses())};var o={uid:0};e.isLoggedIn=!1,e.user=angular.copy(o),r.connect({},function(t){e.user=t.user,e.isLoggedIn=!angular.isUndefined(t.user)&&t.user.uid>0}),e.login=function(){return e.user.name&&e.user.pass?(e.user&&0!==e.user.uid||a.login({username:e.user.name,password:e.user.pass},function(t){e.user=t.user,e.isLoggedIn=!angular.isUndefined(t.user)&&t.user.uid>0}),void 0):!1},e.logout=function(){a.logout({},function(t){t.result&&(e.user=angular.copy(o),e.isLoggedIn=!1)})}}]),cdPage.controller("PageCtrl",["$scope","pageState",function(e,t){e.pageState=t}]),cdPage.factory("pageState",function(){var e="loading",t="Checkdesk",r="Checkdesk";return{status:function(t){return t&&(e=t),e},headTitle:function(e){return e&&(t=e),t},title:function(e){return e&&(r=e),r}}}),cdPage.controller("WidgetsSidebarCtrl",["$scope","$translate","System","User",function(e){e.logoSrc="http://qa.checkdesk.org/sites/qa.checkdesk.org/files/checkdesk_theme/meedan.png",e.featuredStories=[{href:"/story/1510",title:"الشعب يريد إقالةالوزير المتحرش",imageSrc:"http://qa.checkdesk.org/sites/qa.checkdesk.org/files/styles/featured_stories_lead_image/public/adbusters_blog_occupygezi_s_2.jpg?itok=uYCbtd7B",description:'أثار رد وزير الإعلام "صلاح عبد المقصود" على سؤال أحدى الصحفيات في مؤتمر صحفي أمس ضجة كبيرة على مواقع التواصل...'}],e.followLinks=[{href:"https://www.facebook.com/YomatyEgypt",icon:"icon-facebook"},{href:"https://twitter.com/YomatyEgypt",icon:"icon-twitter"},{href:"http://www.youtube.com/user/weladelbaladlt",icon:"icon-youtube"}]}]),cdReport.controller("ReportCtrl",["$scope","$routeParams","pageState","Report","ReportActivity",function(e,t,r,a,n){e.report=a.get({nid:t.nid},function(){r.status("ready")}),e.reportActivity=n.query({args:[t.nid]})}]),cdReport.controller("ReportFormCtrl",["$scope","$routeParams","$location","Report",function(e,t,r,a){e.report=t.nid?a.get({nid:t.nid}):new a({title:"",type:"media",body:{und:[{url:""}]},field_link:{und:[{url:""}]}}),e.submit=function(){return e.report.save(function(e){r.path("/report/"+e.nid)}),!1},e.cancel=function(){t.nid?r.path("/report/"+t.nid):r.path("/")}}]),cdReport.controller("ReportsCtrl",["$scope","pageState","Report",function(e,t,r){e.reports=[],r.query(function(a){for(var n=0;a.length>n;n++)e.reports.push(r.get({nid:a[n].nid}));t.status("ready")})}]),cdServices.factory("Comment",["$resource",function(e){return e("api/node/:nid/comments",{},{query:{method:"GET",isArray:!0}})}]),cdServices.factory("Liveblog",["$resource",function(e){return e("api/views/liveblog",{},{query:{method:"GET",params:{display_id:"services_1",args:[]},isArray:!0}})}]),cdServices.factory("Report",["$resource","$http",function(e){var t=e("api/node/:nid",{nid:"@nid"},{query:{method:"GET",params:{nid:"","parameters[type]":"media",pagesize:5},isArray:!0},get:{method:"GET",isArray:!1},save:{method:"POST",params:{nid:""}},update:{method:"PUT"}});return angular.extend(t.prototype,{save:function(e){return this.nid?this.$update(e):this.$save(e)}}),t}]),cdServices.factory("ReportActivity",["$resource",function(e){return e("api/views/activity_report",{},{query:{method:"GET",params:{display_id:"services_1",args:[]},isArray:!0}})}]),cdServices.factory("Story",["$resource","$http",function(e){var t=e("api/node/:nid",{nid:"@nid"},{query:{method:"GET",params:{nid:"","parameters[type]":"discussion",pagesize:5},isArray:!0},get:{method:"GET",isArray:!1},save:{method:"POST",params:{nid:""}},update:{method:"PUT"}});return angular.extend(t.prototype,{save:function(e){return this.nid?this.$update(e):this.$save(e)}}),t}]),cdServices.factory("System",["$resource",function(e){return e("api/system/:verb",{},{connect:{method:"POST",params:{verb:"connect"},isArray:!1}})}]),cdServices.factory("Translation",["$resource","$http",function(e){var t=e("api/i18n/:lid",{lid:"@lid"},{query:{method:"GET",params:{lid:"",textgroup:"ui"},isArray:!1},save:{method:"POST",params:{lid:""}},update:{method:"PUT"},remove:{method:"DELETE"}});return angular.extend(t.prototype,{save:function(e){return this.lid?this.$update(e):this.$save(e)}}),t}]),cdServices.factory("Update",["$resource","$http",function(e){var t=e("api/node/:nid",{nid:"@nid"},{query:{method:"GET",params:{nid:"","parameters[type]":"post",pagesize:5},isArray:!0},get:{method:"GET",isArray:!1},save:{method:"POST",params:{nid:""}},update:{method:"PUT"}});return angular.extend(t.prototype,{save:function(e){return this.nid?this.$update(e):this.$save(e)}}),t}]),cdServices.factory("User",["$resource","$http",function(e,t){return e("api/user/:verb",{},{login:{method:"POST",params:{verb:"login"},isArray:!1},logout:{method:"POST",params:{verb:"logout"},isArray:!1,transformResponse:t.defaults.transformResponse.concat([function(e){return angular.isArray(e)&&e.length>0?{result:e[0]}:{result:!1}}])}})}]),angular.module("cd.translationUI",["pascalprecht.translate"]).provider("cdTranslationUI",function(){var e,t={},r=function(e,r){angular.isUndefined(t[r])&&(t[r]={}),angular.isUndefined(t[r][e])&&(t[r][e]="")};this.translationTable=function(t){return angular.isUndefined(t)||(e=t),e},this.missingTranslations=function(){return t},r.translationTable=this.translationTable,r.missingTranslations=this.missingTranslations,this.$get=function(){return r}}).config(["$translateProvider","cdTranslationUIProvider",function(e,t){t.translationTable(e.translations())}]).controller("cdTranslationUICtrl",["$scope","$translate","cdTranslationUI","Translation",function(e,t,r,a){e.collapsed=!0,e.toggle=function(){e.collapsed=!e.collapsed},e.$translate=t,e.cdTranslationUI=r,e.translationTable=r.translationTable(),e.missingTranslations=r.missingTranslations(),e.allTranslations={},e.languages=[],e.$watch("translationTable",function(t){e.languages=[],angular.forEach(t,function(t,r){e.languages.push(r)}),angular.forEach(t,function(t,r){angular.forEach(t,function(t,a){angular.isUndefined(e.allTranslations[a])&&(e.allTranslations[a]={}),angular.isUndefined(e.allTranslations[a][r])&&(e.allTranslations[a][r]=t),angular.forEach(e.languages,function(t){angular.isUndefined(e.allTranslations[a][t])&&(e.allTranslations[a][t]="")})})})},!0),e.$watch("missingTranslations",function(t){angular.forEach(t,function(t,r){angular.forEach(t,function(t,a){angular.isUndefined(e.allTranslations[a])&&(e.allTranslations[a]={}),angular.isUndefined(e.allTranslations[a][r])&&(e.allTranslations[a][r]=t),angular.forEach(e.languages,function(t){angular.isUndefined(e.allTranslations[a][t])&&(e.allTranslations[a][t]="")})})})},!0),e.translationChanged=function(){},e.save=function(r,n){var o;return e.allTranslations[n][r]?(o=new a({language:r,source:n,translation:e.allTranslations[n][r],textgroup:"ui"}),o.save(function(){e.translationTable[r][n]=e.allTranslations[n][r],t.uses(t.uses())}),void 0):!1}}]);