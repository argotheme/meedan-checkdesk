/*! checkdesk - v0.1.0 */
var app=angular.module("Checkdesk",["pascalprecht.translate","cd.l10n","cd.translationUI","cd.page","cd.services"]),cdServices=angular.module("cd.services",["ngResource","cd.csrfToken"]);app.config(["$routeProvider","$locationProvider",function(e,r){r.html5Mode(!0).hashPrefix("!"),e.when("/reports",{templateUrl:"templates/reports.html",controller:ReportsCtrl}),e.when("/report/add",{templateUrl:"templates/reportForm.html",controller:ReportFormCtrl}),e.when("/report/:nid",{templateUrl:"templates/report.html",controller:ReportCtrl}),e.when("/report/:nid/edit",{templateUrl:"templates/reportForm.html",controller:ReportFormCtrl}),e.when("/translationsTest",{templateUrl:"templates/translationsTest.html",controller:TranslationsTestCtrl}),e.otherwise({redirectTo:"/reports"})}]),angular.module("cd.csrfToken",[]).config(["$httpProvider",function(e){e.defaults.xsrfCookieName="CSRF-Token",e.defaults.xsrfHeaderName="X-CSRF-Token"}]),angular.module("cd.l10n",["ngCookies","pascalprecht.translate","cd.translationUI"]).config(["$translateProvider",function(e){e.useUrlLoader("api/i18n?textgroup=ui&angular=1"),e.preferredLanguage("ar"),e.useCookieStorage(),e.useMissingTranslationHandler("cdTranslationUI")}]),angular.module("cd.page",[]).factory("pageState",function(){var e="loading",r="Checkdesk";return{status:function(r){return r&&(e=r),e},title:function(e){return e&&(r=e),r}}}),cdServices.factory("Comment",["$resource",function(e){return e("api/node/:nid/comments",{},{query:{method:"GET",isArray:!0}})}]),cdServices.factory("Report",["$resource","$http",function(e){var r=e("api/node/:nid",{nid:"@nid"},{query:{method:"GET",params:{nid:"","parameters[type]":"media",pagesize:5},isArray:!0},get:{method:"GET",isArray:!1},save:{method:"POST",params:{nid:""}},update:{method:"PUT"}});return angular.extend(r.prototype,{save:function(e){return this.nid?this.$update(e):this.$save(e)}}),r}]),cdServices.factory("ReportActivity",["$resource",function(e){return e("api/views/activity_report",{},{query:{method:"GET",params:{display_id:"services_1",args:[]},isArray:!0}})}]),cdServices.factory("Story",["$resource","$http",function(e){var r=e("api/node/:nid",{nid:"@nid"},{query:{method:"GET",params:{nid:"","parameters[type]":"discussion",pagesize:5},isArray:!0},get:{method:"GET",isArray:!1},save:{method:"POST",params:{nid:""}},update:{method:"PUT"}});return angular.extend(r.prototype,{save:function(e){return this.nid?this.$update(e):this.$save(e)}}),r}]),cdServices.factory("System",["$resource",function(e){return e("api/system/:verb",{},{connect:{method:"POST",params:{verb:"connect"},isArray:!1}})}]),cdServices.factory("Translation",["$resource","$http",function(e){var r=e("api/i18n/:lid",{lid:"@lid"},{query:{method:"GET",params:{lid:"",textgroup:"ui"},isArray:!1},save:{method:"POST",params:{lid:""}},update:{method:"PUT"},remove:{method:"DELETE"}});return angular.extend(r.prototype,{save:function(e){return this.lid?this.$update(e):this.$save(e)}}),r}]),cdServices.factory("Update",["$resource","$http",function(e){var r=e("api/node/:nid",{nid:"@nid"},{query:{method:"GET",params:{nid:"","parameters[type]":"post",pagesize:5},isArray:!0},get:{method:"GET",isArray:!1},save:{method:"POST",params:{nid:""}},update:{method:"PUT"}});return angular.extend(r.prototype,{save:function(e){return this.nid?this.$update(e):this.$save(e)}}),r}]),cdServices.factory("User",["$resource","$http",function(e,r){return e("api/user/:verb",{},{login:{method:"POST",params:{verb:"login"},isArray:!1},logout:{method:"POST",params:{verb:"logout"},isArray:!1,transformResponse:r.defaults.transformResponse.concat([function(e){return angular.isArray(e)&&e.length>0?{result:e[0]}:{result:!1}}])}})}]),angular.module("cd.translationUI",["pascalprecht.translate"]).provider("cdTranslationUI",function(){var e,r=[],t=function(e){-1===r.indexOf(e)&&r.push(e)};this.translationTable=function(r){return angular.isUndefined(r)||(e=r),e},this.missingTranslations=function(){return r},t.translationTable=this.translationTable,t.missingTranslations=this.missingTranslations,this.$get=function(){return t}}).config(["$translateProvider","cdTranslationUIProvider",function(e,r){r.translationTable(e.translations())}]).controller("cdTranslationUICtrl",["$scope","$translate","cdTranslationUI",function(e,r,t){var n={};e.collapsed=!0,e.toggle=function(){e.collapsed=!e.collapsed},e.$translate=r,e.cdTranslationUI=t,e.translationTable=t.translationTable(),e.editedTranslations={},e.languages=function(){var r,t=[];for(r in e.translationTable)e.translationTable.hasOwnProperty(r)&&t.push(r);return t},e.translationSources=function(){var r,a,o,s,i=t.translationTable(),l=t.missingTranslations(),u=e.languages();for(r in i)if(i.hasOwnProperty(r))for(a in i[r])if(i[r].hasOwnProperty(a)&&!a.match(/^\$\$/)){for(n[a]=n[a]||{},s=u.length-1;s>=0;s--)n[a][u[s]]="";n[a][r]=i[r][a]}for(o=l.length-1;o>=0;o--)if(a=l[o],angular.isUndefined(n[a]))for(n[a]={},s=u.length-1;s>=0;s--)angular.isUndefined(n[a][u[s]])&&(n[a][u[s]]="");return n},e.translationChanged=function(t,n){e.translationTable[t][n]=e.editedTranslations[t][n],r.uses(r.uses())}}]);var HeaderCtrl=["$scope","$translate","System","User",function(e,r,t,n){var a=function(e,r){switch(e){case"remove":$("html").removeClass(r);break;case"add":$("html").addClass(r)}};a("add",r.uses()),e.toggleLang=function(){a("remove",r.uses()),"en-NG"===r.uses()?r.uses("ar"):r.uses("en-NG"),a("add",r.uses())};var o={uid:0};e.isLoggedIn=!1,e.user=angular.copy(o),t.connect({},function(r){e.user=r.user,e.isLoggedIn=!angular.isUndefined(r.user)&&r.user.uid>0}),e.login=function(){return e.user.name&&e.user.pass?(e.user&&0!==e.user.uid||n.login({username:e.user.name,password:e.user.pass},function(r){e.user=r.user,e.isLoggedIn=!angular.isUndefined(r.user)&&r.user.uid>0}),void 0):!1},e.logout=function(){n.logout({},function(r){r.result&&(e.user=angular.copy(o),e.isLoggedIn=!1)})}}];app.controller("HeaderCtrl",HeaderCtrl);var PageCtrl=["$scope","pageState",function(e,r){e.pageState=r}];app.controller("PageCtrl",PageCtrl);var ReportCtrl=["$scope","$routeParams","pageState","Report","ReportActivity",function(e,r,t,n,a){e.report=n.get({nid:r.nid},function(){t.status("ready")}),e.reportActivity=a.query({args:[r.nid]})}];app.controller("ReportCtrl",ReportCtrl);var ReportFormCtrl=["$scope","$routeParams","$location","Report",function(e,r,t,n){e.report=r.nid?n.get({nid:r.nid}):new n({title:"",type:"media",body:{und:[{url:""}]},field_link:{und:[{url:""}]}}),e.submit=function(){return e.report.save(function(e){t.path("/report/"+e.nid)}),!1},e.cancel=function(){r.nid?t.path("/report/"+r.nid):t.path("/")}}];app.controller("ReportFormCtrl",ReportFormCtrl);var ReportsCtrl=["$scope","pageState","Report",function(e,r,t){e.reports=[],t.query(function(n){for(var a=0;n.length>a;a++)e.reports.push(t.get({nid:n[a].nid}));r.status("ready")})}];app.controller("ReportsCtrl",ReportsCtrl);var TranslationsTestCtrl=["$scope","$translate","Translation",function(e,r,t){e.translations=t.query({language:r.uses()}),e.translation=new t({language:"",context:"",source:"",translation:"",textgroup:"",location:"",plid:"",plural:""}),e.submit=function(){return e.translation.save(),!1}}];app.controller("TranslationsTestCtrl",TranslationsTestCtrl);